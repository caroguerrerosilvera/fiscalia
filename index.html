<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  </head>
  <body>
    <div>
       <label for="">Usuario:</label>
       <input
        type="text"
        placeholder="Ingresa tu usuario"
        id="usuario"> 
       <label for="">Contrasena:</label>
       <input
        type="password"
        placeholder="Ingresa tu contrasena"
        id="contrasena">
        <span id="error"></span>
    </div>
    <div>
        <button onclick="cargarRegistroUsuario()">Registrarse</button>
        <button onclick="login()">Ingresar</button>
    </div>
    <ul>
        <li>
            <a href="vistas/usuarios/registro.html">Vista registro usuario</a>
        </li>
        <li>
            <a href="vistas/home.html">Vista Home</a>
        </li>
    </ul>
    
    
    <script>window.$ = window.jQuery = require('jquery');</script>
    <script>
        const authControlador = require('./controladores/usuarios.js');

        async function login () {
            const usuario = $('#usuario').val();
            const contrasena = $('#contrasena').val();   
            const respuesta = await authControlador.autenticar(usuario, contrasena);

            if (respuesta.status === 'Error') {
                $('#error').html(respuesta.message);
            } else {
                window.location = './vistas/home.html';
            }
        }

        function cargarRegistroUsuario () {
            window.location = './vistas/usuarios/registro.html';
        }
    </script>
  </body>
</html>
